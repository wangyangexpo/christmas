function getQueryString(e){var t=new RegExp("(^|&)"+e+"=([^&]*)(&|$)","i"),i=window.location.search.substr(1).match(t);return null!=i?decodeURI(i[2]):null}function countDown(e){var t=$(".getcode"),i=setInterval(function(){e?t.text(e-1+"秒"):(t.text("获取验证码"),clearInterval(i)),e--},1e3)}FastClick.attach(document.body);var giftlist={0:{name:"圣诞精灵证书",el:['<img src="../images/zhengshu/zhengshu_','.png" alt="" class="zhengshu">'],pre:"1张"},104:{name:"葡萄积木警车",el:'<img src="../images/opened/jingche.png" alt="" class="jingche">',pre:"1辆"},101:{name:"摩拜单车月卡",el:'<img src="../images/opened/yueka.png" alt="" class="yueka">',pre:"1张"},102:{name:"摩拜单车年卡",el:'<img src="../images/opened/nianka.png" alt="" class="nianka">',pre:"1张"}};$(function(){var e,t=$("#mgmask"),i=getQueryString("nickname")||"",n=getQueryString("giftid")||0,a=getQueryString("isshare")||0,c=getData("mb_code")||"";if($(".wx-name").text(i+"，"),n>=0&&n<=20?(e=giftlist[0]).el=e.el[0]+n+e.el[1]:(e=giftlist[n])?(0==a&&$(".receive").show(),$("#lucky").addClass("find")):(e=giftlist[0]).el=e.el[0]+"0"+e.el[1],is_weixin()){var l=config.shareorigin+"html/mygift_opened.html?giftid="+n+"&nickname="+i+"&isshare=1";wxShare(l,2,e.pre+e.name)}$(".gift-img").html(e.el),$(".gift-name").html(e.name),t.on("click",".icon-close",function(){t.find(".bg-rotate,.gift-img>img").addClass("disappear"),setTimeout(function(){t.hide()},1e3)});var g=$(".getcode"),r=$(".phone"),o=$(".code"),s=$(".commit"),m=/^1[0-9]{10}$/;g.on("click",function(){var e=g.text(),t=$.trim(r.val());11==t.length&&m.test(t)?"获取验证码"==e&&(countDown(60),giftGetCode(t)):alert("请输入正确的手机号")}),s.on("click",function(){var e=$.trim(r.val()),t=$.trim(o.val());console.log(e,t),e?t?giftCheckCode(e,t,function(t){0==t.error_code&&(location.href="./mygift_receive.html?giftid="+n+"&mb_code="+c+"&phone="+e+"&nickname="+i)}):alert("请输入验证码！"):alert("请输入手机号！")})});